<Window x:Class="LSR.XmlHelper.Wpf.Views.BackupBrowserWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Backup Browser"
        Width="820"
        Height="520"
        WindowStartupLocation="CenterOwner"
        Background="{Binding Appearance.BackgroundBrush}"
        Foreground="{Binding Appearance.TextBrush}"
        FontFamily="{Binding Appearance.UiFontFamily}"
        FontSize="{Binding Appearance.UiFontSize}">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="8" />
            <RowDefinition Height="*" />
            <RowDefinition Height="8" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="10" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Vertical">
            <TextBlock Text="Backups for:" FontSize="16" FontWeight="Bold" Foreground="{Binding Appearance.HeaderTextBrush}" />
            <TextBlock Text="{Binding XmlFileName}" Margin="0,2,0,0" />
            <TextBlock Text="{Binding BackupFolder}" Opacity="0.75" TextWrapping="Wrap" />
        </StackPanel>

        <Border Grid.Row="2"
                BorderThickness="1"
                BorderBrush="{Binding Appearance.GridLinesBrush}"
                Background="{Binding Appearance.ValueColumnBackgroundBrush}">
            <ListView ItemsSource="{Binding Backups}"
                      SelectedItem="{Binding SelectedBackup}"
                      Background="{Binding Appearance.ValueColumnBackgroundBrush}"
                      Foreground="{Binding Appearance.ValueColumnTextBrush}"
                      BorderThickness="0">
                <ListView.Resources>
                    <Style TargetType="{x:Type GridViewColumnHeader}">
                        <Setter Property="Background" Value="{Binding DataContext.Appearance.GridHeaderBackgroundBrush, RelativeSource={RelativeSource AncestorType=Window}}" />
                        <Setter Property="Foreground" Value="{Binding DataContext.Appearance.GridHeaderTextBrush, RelativeSource={RelativeSource AncestorType=Window}}" />
                        <Setter Property="FontWeight" Value="Bold" />
                        <Setter Property="Padding" Value="8,4" />
                    </Style>

                    <Style TargetType="{x:Type ListViewItem}">
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="Foreground" Value="{Binding DataContext.Appearance.ValueColumnTextBrush, RelativeSource={RelativeSource AncestorType=Window}}" />
                        <Setter Property="Padding" Value="6,3" />
                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{Binding DataContext.Appearance.GridRowHoverBackgroundBrush, RelativeSource={RelativeSource AncestorType=Window}}" />
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="{Binding DataContext.Appearance.GridRowSelectedBackgroundBrush, RelativeSource={RelativeSource AncestorType=Window}}" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </ListView.Resources>

                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="Date" Width="170" DisplayMemberBinding="{Binding LastWriteText}" />
                        <GridViewColumn Header="Backup file" Width="510" DisplayMemberBinding="{Binding FileName}" />
                        <GridViewColumn Header="Size" Width="90" DisplayMemberBinding="{Binding SizeText}" />
                    </GridView>
                </ListView.View>
            </ListView>
        </Border>

        <TextBlock Grid.Row="4"
                   Text="{Binding Status}"
                   Foreground="{Binding Appearance.HeaderTextBrush}" />

        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Right">
            <StackPanel.Resources>
                <Style TargetType="{x:Type Button}">
                    <Setter Property="Foreground" Value="{Binding Appearance.TopButtonTextBrush}" />
                    <Setter Property="Background" Value="{Binding Appearance.TopButtonBackgroundBrush}" />
                    <Setter Property="Padding" Value="10,6" />
                    <Setter Property="MinWidth" Value="120" />
                    <Setter Property="Margin" Value="0,0,8,0" />
                </Style>
            </StackPanel.Resources>

            <Button Content="Refresh" Command="{Binding RefreshCommand}" MinWidth="90" />
            <Button Content="Open Folder" Command="{Binding OpenBackupFolderCommand}" MinWidth="110" />
            <Button Content="Restore Selected" Command="{Binding RestoreCommand}" />
            <Button Content="Cancel" Command="{Binding CancelCommand}" Margin="0,0,0,0" />
        </StackPanel>
    </Grid>
</Window>
